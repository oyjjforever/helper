(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["order"],{"13a3":function(e,t,a){},"1af6":function(e,t,a){var r=a("63b6");r(r.S,"Array",{isArray:a("9003")})},"20fd":function(e,t,a){"use strict";var r=a("d9f6"),n=a("aebd");e.exports=function(e,t,a){t in e?r.f(e,t,n(0,a)):e[t]=a}},"273d":function(e,t,a){"use strict";var r=a("6f9f"),n=a.n(r);n.a},"28a5":function(e,t,a){"use strict";var r=a("aae3"),n=a("cb7c"),i=a("ebd6"),o=a("0390"),s=a("9def"),l=a("5f1b"),c=a("520a"),u=a("79e5"),d=Math.min,p=[].push,m="split",g="length",f="lastIndex",h=4294967295,v=!u((function(){RegExp(h,"y")}));a("214f")("split",2,(function(e,t,a,u){var w;return w="c"=="abbc"[m](/(b)*/)[1]||4!="test"[m](/(?:)/,-1)[g]||2!="ab"[m](/(?:ab)*/)[g]||4!="."[m](/(.?)(.?)/)[g]||"."[m](/()()/)[g]>1||""[m](/.?/)[g]?function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!r(e))return a.call(n,e,t);var i,o,s,l=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,m=void 0===t?h:t>>>0,v=new RegExp(e.source,u+"g");while(i=c.call(v,n)){if(o=v[f],o>d&&(l.push(n.slice(d,i.index)),i[g]>1&&i.index<n[g]&&p.apply(l,i.slice(1)),s=i[0][g],d=o,l[g]>=m))break;v[f]===i.index&&v[f]++}return d===n[g]?!s&&v.test("")||l.push(""):l.push(n.slice(d)),l[g]>m?l.slice(0,m):l}:"0"[m](void 0,0)[g]?function(e,t){return void 0===e&&0===t?[]:a.call(this,e,t)}:a,[function(a,r){var n=e(this),i=void 0==a?void 0:a[t];return void 0!==i?i.call(a,n,r):w.call(String(n),a,r)},function(e,t){var r=u(w,e,this,t,w!==a);if(r.done)return r.value;var c=n(e),p=String(this),m=i(c,RegExp),g=c.unicode,f=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(v?"y":"g"),b=new m(v?c:"^(?:"+c.source+")",f),y=void 0===t?h:t>>>0;if(0===y)return[];if(0===p.length)return null===l(b,p)?[p]:[];var x=0,k=0,D=[];while(k<p.length){b.lastIndex=v?k:0;var _,O=l(b,v?p:p.slice(k));if(null===O||(_=d(s(b.lastIndex+(v?0:k)),p.length))===x)k=o(p,k,g);else{if(D.push(p.slice(x,k)),D.length===y)return D;for(var S=1;S<=O.length-1;S++)if(D.push(O[S]),D.length===y)return D;k=x=_}}return D.push(p.slice(x)),D}]}))},"3ce6":function(e,t,a){},"4a60":function(e,t,a){"use strict";var r=a("3ce6"),n=a.n(r);n.a},5410:function(e,t,a){},"549b":function(e,t,a){"use strict";var r=a("d864"),n=a("63b6"),i=a("241e"),o=a("b0dc"),s=a("3702"),l=a("b447"),c=a("20fd"),u=a("7cd6");n(n.S+n.F*!a("4ee1")((function(e){Array.from(e)})),"Array",{from:function(e){var t,a,n,d,p=i(e),m="function"==typeof this?this:Array,g=arguments.length,f=g>1?arguments[1]:void 0,h=void 0!==f,v=0,w=u(p);if(h&&(f=r(f,g>2?arguments[2]:void 0,2)),void 0==w||m==Array&&s(w))for(t=l(p.length),a=new m(t);t>v;v++)c(a,v,h?f(p[v],v):p[v]);else for(d=w.call(p),a=new m;!(n=d.next()).done;v++)c(a,v,h?o(d,f,[n.value,v],!0):n.value);return a.length=v,a}})},"54a1":function(e,t,a){a("6c1c"),a("1654"),e.exports=a("95d5")},"634a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("orderMain",{on:{queryOrderDetail:function(t){return e.$refs["orderDetail"].featchData(t.id)}}}),a("orderDetail",{ref:"orderDetail"})],1)},n=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"orderMain-maintenance"},[a("div",{staticClass:"tool-bar"},[a("el-link",{attrs:{icon:"el-icon-document-add"},on:{click:e.onAdd}},[e._v("新增")]),a("div",{staticClass:"split-line"})],1),a("div",{staticClass:"orderMain-container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.grid.loading,expression:"grid.loading"}],ref:"table",attrs:{border:"",stripe:"",data:e.grid.rows,height:e.grid.height,"highlight-current-row":""},on:{"row-click":e.onRowClick,"selection-change":function(t){return e.grid.selectedRow=t}}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"orderDate",label:"下单时间",align:"left","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"name",label:"客户姓名",align:"left","show-overflow-tooltip":""}}),e._v("、\n      "),a("el-table-column",{attrs:{prop:"sendDate",label:"送货时间",align:"left","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"left","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{width:"100",align:"center",prop:"status",label:"状态","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.status?a("el-tag",{attrs:{type:"success"}},[e._v("已完成")]):"1"===t.row.status?a("el-tag",{attrs:{type:"danger"}},[e._v("待付款")]):"2"===t.row.status?a("el-tag",{attrs:{type:"danger"}},[e._v("待尾款")]):"3"===t.row.status?a("el-tag",{attrs:{type:"danger"}},[e._v("待送货")]):e._e()]}}])}),a("el-table-column",{attrs:{align:"center",width:"100",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"light",placement:"bottom-start",content:"查看详情",enterable:!1}},[a("el-link",{staticStyle:{"font-size":"20px",margin:"0 5px 0 0"},attrs:{icon:"el-icon-view"},on:{click:function(a){return e.onView(t.row)}}})],1),a("el-tooltip",{attrs:{effect:"light",placement:"bottom-start",content:"编辑",enterable:!1}},[a("el-link",{staticStyle:{"font-size":"20px",margin:"0 5px 0 0"},attrs:{icon:"el-icon-edit-outline"},on:{click:function(a){return e.onUpdate(t.row)}}})],1),a("el-tooltip",{attrs:{effect:"light",placement:"bottom-start",content:"删除",enterable:!1}},[a("el-link",{staticStyle:{"font-size":"20px",margin:"0 5px 0 0"},attrs:{icon:"el-icon-delete"},on:{click:function(a){return e.onDelete(t.row)}}})],1)]}}])})],1),a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next","page-sizes":[10,30,50],"page-size":e.pagging.pageSize,"current-page":e.pagging.pageNum,total:e.pagging.total},on:{"size-change":e.onChangePageSize,"current-change":e.onChangeCurrentPage}})],1),e.dialog.show?a("el-dialog",{directives:[{name:"dialog",rawName:"v-dialog"}],attrs:{width:"700px",visible:e.dialog.show,"modal-append-to-body":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[a("i",{class:e.dialogMode.icon}),a("span",[e._v("订单维护 —— "+e._s(e.dialogMode.title))])]),a("el-form",{ref:"form",attrs:{disabled:3===e.dialog.mode,rules:e.dialog.rules,model:e.dialog.data,"label-width":"110px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"客户姓名",prop:"name"}},[a("el-input",{model:{value:e.dialog.data.name,callback:function(t){e.$set(e.dialog.data,"name","string"===typeof t?t.trim():t)},expression:"dialog.data.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"下单时间",prop:"orderDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.dialog.data.orderDate,callback:function(t){e.$set(e.dialog.data,"orderDate",t)},expression:"dialog.data.orderDate"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"客户电话",prop:"phone"}},[a("el-input",{model:{value:e.dialog.data.phone,callback:function(t){e.$set(e.dialog.data,"phone","string"===typeof t?t.trim():t)},expression:"dialog.data.phone"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"送货时间",prop:"sendDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.dialog.data.sendDate,callback:function(t){e.$set(e.dialog.data,"sendDate",t)},expression:"dialog.data.sendDate"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{maxlength:"50",type:"textarea","show-word-limit":"",placeholder:"请输入内容"},model:{value:e.dialog.data.remark,callback:function(t){e.$set(e.dialog.data,"remark",t)},expression:"dialog.data.remark"}})],1)],1)],1),a("el-row",{attrs:{span:24}},[a("order-timeLine",{directives:[{name:"show",rawName:"v-show",value:3===e.dialog.mode,expression:"dialog.mode === 3"}],ref:"orderTimeLine",attrs:{mainId:e.dialog.data.id}})],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:3!==e.dialog.mode,expression:"dialog.mode !== 3"}],attrs:{label:"状态",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.dialog.data.status,callback:function(t){e.$set(e.dialog.data,"status",t)},expression:"dialog.data.status"}},[a("el-option",{attrs:{label:"待付款",value:"1"}}),a("el-option",{attrs:{label:"待尾款",value:"2"}}),a("el-option",{attrs:{label:"待送货",value:"3"}}),a("el-option",{attrs:{label:"已完成",value:"0"}})],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:3!==e.dialog.mode,expression:"dialog.mode !== 3"}],attrs:{label:"编制人",prop:"userName"}},[a("el-input",{attrs:{disabled:""},model:{value:e.dialog.data.userName,callback:function(t){e.$set(e.dialog.data,"userName",t)},expression:"dialog.data.userName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:3!==e.dialog.mode,expression:"dialog.mode !== 3"}],attrs:{label:"编制时间",prop:"createTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:"","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.dialog.data.createTime,callback:function(t){e.$set(e.dialog.data,"createTime",t)},expression:"dialog.data.createTime"}})],1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:3!==e.dialog.mode,expression:"dialog.mode !== 3"}],attrs:{type:"primary",icon:"fa fa-save"},on:{click:e.onSave}},[e._v(" 保存")])],1)],1):e._e()],1)},o=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("7f7f"),a("28a5"),a("bd86")),l=(a("96cf"),a("3b8d")),c=a("c32d"),u=a.n(c),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"order-timeLine"},[a("el-timeline",e._l(e.activities,(function(t,r){return a("el-timeline-item",{key:r,attrs:{timestamp:t.timestamp}},[e._v("\n      "+e._s(t.content)+"\n    ")])})),1)],1)},p=[],m={name:"order-timeLine",props:{mainId:String},data:function(){return{activities:[]}},created:function(){this.featchData()},methods:{featchData:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.queryData({params:{mapperId:"com.bosssoft.monitor.dao.OrderMapper.queryTimeLine",mainId:this.mainId}});case 2:t=e.sent,a=t.data,this.activities=a.data;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),save:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.add({data:{mapperId:"com.bosssoft.monitor.dao.OrderMapper.insertTimeLine",mainId:t,timestamp:u()().format("YYYY-MM-DD HH:mm:ss"),content:a}});case 2:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}()}},g=m,f=(a("273d"),a("2877")),h=Object(f["a"])(g,d,p,!1,null,"4b8e09ee",null),v=h.exports;function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(a,!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y={name:"",components:{orderTimeLine:v},data:function(){return{grid:{rows:[],height:null,loading:!1,selectedRow:[]},pagging:{total:0,pageNum:1,pageSize:10},dialog:{mode:null,show:!1,data:{orderDate:null,sendDate:null,name:null,phone:null,address:null,remark:null,status:null,createBy:null,userName:null,createTime:null},rules:{reformTheme:[{required:!0,message:"请填写客户姓名！",trigger:"blur"}],orderDate:[{required:!0,message:"请选择下单时间！",trigger:"blur"}]}}}},computed:{dialogMode:function(){switch(this.dialog.mode){case 1:return{title:"新增",icon:"el-icon-document-add",message:"添加成功！"};case 2:return{title:"编辑",icon:"el-icon-edit-outline",message:"修改成功！"};case 3:return{title:"查看",icon:"el-icon-document"};default:return{}}}},created:function(){this.featchData()},mounted:function(){this.resize(),window.addEventListener("resize",this.resize)},beforeDestroy:function(){window.removeEventListener("resize",this.resize)},methods:{featchData:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.grid.loading=!0,e.next=3,this.$api.pagingData({params:{mapperId:"com.bosssoft.monitor.dao.OrderMapper.queryOrder",pageNum:this.pagging.pageNum,pageSize:this.pagging.pageSize}});case 3:t=e.sent,a=t.data,this.grid.loading=!1,this.grid.rows=a.data.rows,this.pagging.total=a.data.total,this.pagging.pageNum=a.data.pageNum,this.pagging.pageSize=a.data.pageSize;case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onQuery:function(){this.pagging.pageNum=1,this.featchData()},onChangeCurrentPage:function(e){this.pagging.pageNum=e,this.featchData()},onChangePageSize:function(e){this.pagging.pageNum=1,this.pagging.pageSize=e,this.featchData()},validateBeforeAdd:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),onAdd:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.validateBeforeAdd();case 3:t={reformTheme:"",orderDate:u()().format("YYYY-MM-DD"),remark:"",status:"1",userId:this.$store.state.user.userInfo.userId,userName:this.$store.state.user.userInfo.userName,createTime:u()().format("YYYY-MM-DD HH:mm:ss")},this.dialog.mode=1,this.dialog.show=!0,this.dialog.data=t,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),e.t0.message&&this.$message.error(e.t0.message);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}(),onView:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.dialog.mode=3,this.dialog.show=!0,this.dialog.data=Object.assign({},t);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),validateBeforeDelete:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),onDelete:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.validateBeforeDelete(t);case 3:this.$confirm("您确定要删除当前选中的记录吗?","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.$api.remove({params:{mapperId:"com.bosssoft.monitor.dao.OrderMapper.deleteOrder",id:t.id}});case 2:a.featchData(),a.$message.success("删除成功！");case 4:case"end":return e.stop()}}),e)})))).catch((function(){})),e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),e.t0.message&&this.$message.error(e.t0.message);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));function t(t){return e.apply(this,arguments)}return t}(),onUpdate:function(e){this.dialog.mode=2,this.dialog.show=!0,e.createTime=u()().format("YYYY-MM-DD"),this.dialog.data=Object.assign({},e)},validateBeforeSave:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs["form"].validate();case 2:return e.abrupt("return",Promise.resolve());case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onSave:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.validateBeforeSave();case 3:if(t="",a="",1!==this.dialog.mode){e.next=14;break}return e.next=8,this.$api.add({data:b({mapperId:"com.bosssoft.monitor.dao.OrderMapper.insertOrder"},this.dialog.data)});case 8:r=e.sent,n=r.data,t=this.$store.state.user.userInfo.userName+"创建订单",a=n.data.id.split("-").join(""),e.next=19;break;case 14:return i=this.dialog.data,e.next=17,this.$api.modify({data:{mapperId:"com.bosssoft.monitor.dao.OrderMapper.updateOrder",id:i.id,name:i.name,phone:i.phone,address:i.address,sendDate:i.sendDate,remark:i.remark,status:i.status}});case 17:t=this.$store.state.user.userInfo.userName+"修改订单",a=i.id;case 19:return e.next=21,this.$refs["orderTimeLine"].save(a,t);case 21:this.featchData(),this.dialog.show=!1,this.$message.success(this.dialogMode.message),e.next=29;break;case 26:e.prev=26,e.t0=e["catch"](0),e.t0.message&&this.$message.error(e.t0.message);case 29:case"end":return e.stop()}}),e,this,[[0,26]])})));function t(){return e.apply(this,arguments)}return t}(),resize:function(){this.grid.height=this.$el.clientHeight-80},onRowClick:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs["table"].clearSelection(),this.$refs["table"].toggleRowSelection(t),this.$emit("queryOrderDetail",t);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},x=y,k=(a("88ed"),Object(f["a"])(x,i,o,!1,null,"05d6fee8",null)),D=k.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"orderDetail-maintenance"},[a("div",{staticClass:"tool-bar"},[a("el-link",{directives:[{name:"show",rawName:"v-show",value:!e.isUpdating,expression:"!isUpdating"}],attrs:{icon:"el-icon-edit-outline"},on:{click:e.onUpdate}},[e._v("编辑")]),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.isUpdating,expression:"isUpdating"}],attrs:{icon:"el-icon-circle-close"},on:{click:e.onCancel}},[e._v("取消")]),a("div",{staticClass:"split-line"}),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.isUpdating,expression:"isUpdating"}],attrs:{icon:"el-icon-circle-check"},on:{click:e.onSave}},[e._v("保存")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isUpdating,expression:"isUpdating"}],staticClass:"split-line"}),a("el-link",{directives:[{name:"show",rawName:"v-show",value:e.isUpdating,expression:"isUpdating"}],attrs:{icon:"el-icon-circle-plus-outline"},on:{click:e.onAdd}},[e._v("增加行")]),a("span",{staticClass:"amount-span"},[e._v(" 总金额："+e._s(e.amount)+" ")])],1),a("order-timeLine",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"orderTimeLine"}),a("div",{staticClass:"orderDetail-container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.grid.loading,expression:"grid.loading"}],ref:"table",attrs:{border:"",stripe:"",data:e.isUpdating?e.modifyDate:e.grid.rows,height:e.grid.height,"highlight-current-row":""},on:{"selection-change":function(t){return e.grid.selectedRow=t}}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{prop:"model",label:"型号",align:"left","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isUpdating?a("el-input",{attrs:{placeholder:"请输入型号"},model:{value:t.row.model,callback:function(a){e.$set(t.row,"model","string"===typeof a?a.trim():a)},expression:"scope.row.model"}}):a("span",[e._v(e._s(t.row.model))])]}}])}),a("el-table-column",{attrs:{prop:"color",label:"颜色",align:"left","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isUpdating?a("el-input",{attrs:{placeholder:"请输入颜色"},model:{value:t.row.color,callback:function(a){e.$set(t.row,"color","string"===typeof a?a.trim():a)},expression:"scope.row.color"}}):a("span",[e._v(e._s(t.row.color))])]}}])}),e._v("、\n      "),a("el-table-column",{attrs:{prop:"format",label:"规格",align:"left","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isUpdating?a("el-input",{attrs:{placeholder:"请输入规格"},model:{value:t.row.format,callback:function(a){e.$set(t.row,"format","string"===typeof a?a.trim():a)},expression:"scope.row.format"}}):a("span",[e._v(e._s(t.row.format))])]}}])}),a("el-table-column",{attrs:{prop:"price",label:"单价",align:"left","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isUpdating?a("el-input",{attrs:{placeholder:"请输入单价"},model:{value:t.row.price,callback:function(a){e.$set(t.row,"price","string"===typeof a?a.trim():a)},expression:"scope.row.price"}}):a("span",[e._v(e._s(t.row.price))])]}}])}),a("el-table-column",{attrs:{prop:"num",label:"数量",align:"left","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isUpdating?a("el-input",{attrs:{placeholder:"请输入数量"},model:{value:t.row.num,callback:function(a){e.$set(t.row,"num","string"===typeof a?a.trim():a)},expression:"scope.row.num"}}):a("span",[e._v(e._s(t.row.num))])]}}])}),a("el-table-column",{attrs:{width:"100",align:"center",prop:"status",label:"状态","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.status?a("el-tag",{attrs:{type:"success"}},[e._v("已送")]):"1"===t.row.status?a("el-tag",{attrs:{type:"danger"}},[e._v("未送")]):e._e()]}}])}),e.isUpdating?a("el-table-column",{attrs:{align:"center",width:"50",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"light",placement:"bottom-start",content:"删除",enterable:!1}},[a("el-link",{staticStyle:{"font-size":"20px",margin:"0 5px 0 0"},attrs:{icon:"el-icon-delete"},on:{click:function(a){return e.onDelete(t.row,t.$index)}}})],1)]}}],null,!1,3228867994)}):e._e()],1),a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next","page-sizes":[10,30,50],"page-size":e.pagging.pageSize,"current-page":e.pagging.pageNum,total:e.pagging.total},on:{"size-change":e.onChangePageSize,"current-change":e.onChangeCurrentPage}})],1)],1)},O=[],S=a("a745"),$=a.n(S);function R(e){if($()(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}var j=a("774e"),N=a.n(j),z=a("c8bb"),I=a.n(z);function C(e){if(I()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return N()(e)}function M(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function U(e){return R(e)||C(e)||M()}var T={name:"",components:{orderTimeLine:v},data:function(){return{isUpdating:!1,grid:{rows:[],height:null,loading:!1,selectedRow:[]},pagging:{total:0,pageNum:1,pageSize:10},mainId:null,deleteDate:[],modifyDate:{model:null,color:null,format:null,price:null,num:null}}},computed:{amount:function(){var e=0,t=this.isUpdating?this.modifyDate:this.grid.rows;return t.forEach((function(t){e+=t.price*t.num})),console.log(e),e}},created:function(){this.featchData()},mounted:function(){this.resize(),window.addEventListener("resize",this.resize)},beforeDestroy:function(){window.removeEventListener("resize",this.resize)},methods:{featchData:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.grid.loading=!0,e.next=3,this.$api.pagingData({params:{mapperId:"com.bosssoft.monitor.dao.OrderMapper.queryOrderDetail",id:t,pageNum:this.pagging.pageNum,pageSize:this.pagging.pageSize}});case 3:a=e.sent,r=a.data,this.mainId=t,this.grid.loading=!1,this.grid.rows=r.data.rows,this.pagging.total=r.data.total,this.pagging.pageNum=r.data.pageNum,this.pagging.pageSize=r.data.pageSize;case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onQuery:function(){this.pagging.pageNum=1,this.featchData()},onChangeCurrentPage:function(e){this.pagging.pageNum=e,this.featchData()},onChangePageSize:function(e){this.pagging.pageNum=1,this.pagging.pageSize=e,this.featchData()},onAdd:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t={mainId:this.mainId,model:"",color:"",format:"",price:null,num:null,operation:"1"},this.modifyDate.push(t);case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),validateBeforeDelete:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),onDelete:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t,a){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.validateBeforeDelete(t);case 3:this.$confirm("您确定要删除当前选中的记录吗?","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r.isUpdating){e.next=5;break}r.modifyDate.splice(a,1),t.operation||(t.operation="-1",r.deleteDate.push(t)),e.next=9;break;case 5:return e.next=7,r.$api.remove({params:{mapperId:"com.bosssoft.monitor.dao.OrderMapper.deleteOrderDetail",id:t.id}});case 7:r.featchData(r.mainId),r.$message.success("删除成功！");case 9:case"end":return e.stop()}}),e)})))).catch((function(){})),e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),e.t0.message&&this.$message.error(e.t0.message);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));function t(t,a){return e.apply(this,arguments)}return t}(),onUpdate:function(){this.isUpdating=!0,this.deleteDate=[],this.modifyDate=this.grid.rows},onCancel:function(){this.isUpdating=!1,this.featchData(this.mainId)},validateBeforeSave:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),updateAmount:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.modify({data:{mapperId:"com.bosssoft.monitor.dao.OrderMapper.updateOrder",id:this.mainId,amount:this.amount}});case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onSave:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a="",e.next=4,this.validateBeforeSave();case 4:return(t=this.modifyDate).push.apply(t,U(this.deleteDate)),r=JSON.stringify(this.modifyDate),e.next=8,this.$api.modifyOrderDetail({headers:{"Content-Type":"application/json;charset=UTF-8"},data:{data:r}});case 8:return a=this.$store.state.user.userInfo.userName+"修改了商品",e.next=11,this.$refs["orderTimeLine"].save(this.mainId,a);case 11:return e.next=13,this.updateAmount();case 13:this.featchData(this.mainId),this.isUpdating=!1,this.$message.success("更新成功！"),e.next=21;break;case 18:e.prev=18,e.t0=e["catch"](0),e.t0.message&&this.$message.error(e.t0.message);case 21:case"end":return e.stop()}}),e,this,[[0,18]])})));function t(){return e.apply(this,arguments)}return t}(),resize:function(){this.grid.height=this.$el.clientHeight-80}}},A=T,P=(a("4a60"),Object(f["a"])(A,_,O,!1,null,"69a59f00",null)),E=P.exports,L={name:"index",components:{orderMain:D,orderDetail:E}},Y=L,B=(a("90b6"),Object(f["a"])(Y,r,n,!1,null,"72ce9acc",null));t["default"]=B.exports},"6f9f":function(e,t,a){},"74b2":function(e,t,a){},"774e":function(e,t,a){e.exports=a("d2d5")},8384:function(e,t,a){"use strict";var r=a("74b2"),n=a.n(r);n.a},"88ed":function(e,t,a){"use strict";var r=a("13a3"),n=a.n(r);n.a},9003:function(e,t,a){var r=a("6b4c");e.exports=Array.isArray||function(e){return"Array"==r(e)}},"90b6":function(e,t,a){"use strict";var r=a("5410"),n=a.n(r);n.a},"95d5":function(e,t,a){var r=a("40c3"),n=a("5168")("iterator"),i=a("481b");e.exports=a("584a").isIterable=function(e){var t=Object(e);return void 0!==t[n]||"@@iterator"in t||i.hasOwnProperty(r(t))}},a745:function(e,t,a){e.exports=a("f410")},c8bb:function(e,t,a){e.exports=a("54a1")},d2d5:function(e,t,a){a("1654"),a("549b"),e.exports=a("584a").Array.from},e66f:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"order-mobile-index"},[a("el-collapse",{attrs:{accordion:""}},e._l(e.orders,(function(t,r){return a("el-collapse-item",{key:r},[a("template",{slot:"title"},[a("span",{staticStyle:{"margin-right":"10px"}},["0"===t.status?a("el-tag",{attrs:{type:"success"}},[e._v("已完成")]):"1"===t.status?a("el-tag",{attrs:{type:"danger"}},[e._v("待付款")]):"2"===t.status?a("el-tag",{attrs:{type:"danger"}},[e._v("待尾款")]):"3"===t.status?a("el-tag",{attrs:{type:"danger"}},[e._v("待送货")]):e._e()],1),e._v("\n        "+e._s(t.name+" - "+t.address)+"\n      ")]),a("div",[e._v("联系方式："+e._s(t.phone))]),a("div",[e._v("订单时间："+e._s(t.orderDate))]),a("div",[e._v("送货时间："+e._s(t.sendDate))]),a("div",[e._v("总金额："+e._s(t.amount))]),a("div",[e._v("备注："+e._s(t.remark))]),a("el-table",{ref:"table",refInFor:!0,attrs:{border:"",stripe:"",data:t.detail,"highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"model",label:"型号",align:"left","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"color",label:"颜色",align:"left","show-overflow-tooltip":""}}),e._v("、\n        "),a("el-table-column",{attrs:{prop:"format",label:"规格",align:"left","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"price",label:"单价",align:"left","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"num",label:"数量",align:"left","show-overflow-tooltip":""}})],1)],2)})),1)],1)},n=[],i=(a("7f7f"),a("ac6a"),a("96cf"),a("3b8d")),o={name:"index",data:function(){return{orders:[]}},created:function(){this.featchData()},methods:{featchData:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.queryData({params:{mapperId:"com.bosssoft.monitor.dao.OrderMapper.queryWholeOrderSelective"}});case 2:t=e.sent,a=t.data,this.orders=this.formatOrderData(a.data);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),formatOrderData:function(e){var t=[],a=[];for(var r in e.forEach((function(e){if(!a[e.id]){var t={id:e.id,name:e.name,phone:e.phone,address:e.address,orderDate:e.orderDate,sendDate:e.sendDate,amount:e.amount,remark:e.remark,status:e.status,detail:[]};a[e.id]=t}a[e.id]["detail"].push({model:e.model,color:e.color,format:e.format,price:e.price,num:e.num,discount:e.discount})})),a)t.push(a[r]);return t}}},s=o,l=(a("8384"),a("2877")),c=Object(l["a"])(s,r,n,!1,null,"52bee168",null);t["default"]=c.exports},f410:function(e,t,a){a("1af6"),e.exports=a("584a").Array.isArray}}]);
//# sourceMappingURL=order.b2718b57.js.map